import{r as k,j as e}from"./app-Bw-HDS2U.js";import{c as p}from"./createLucideIcon-KLntpfR-.js";import{C as _}from"./chevron-down-DfdzDdl_.js";import{F as f}from"./FieldGroup-DfIXWzzT.js";import{S as x}from"./react-select.esm-Bzu0L5ce.js";import{T as w,C as $}from"./ConfirmDelete-Bgu9-U39.js";import{C as P}from"./CancelButton-B-4g2p0d.js";import{L as B}from"./LoadingButton-CBhzQhfh.js";/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],g=p("chevron-up",R);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],D=p("plus",U);function E({title:l,fontSize:d="xl",initialExpanded:r=!0,className:i="",onToggle:u="",children:a}){const[n,h]=k.useState(r),b=()=>{h(!n),u&&u(!n)};return e.jsxs("div",{className:`content-box mb-3 ${i} ${r?"h-full":"h-auto"}`,children:[e.jsxs("div",{onClick:b,className:`flex items-center justify-between cursor-pointer ${n?"mb-2":"mb-0"}`,children:[e.jsx("h2",{className:`text-${d} font-semibold`,children:l}),e.jsx("button",{type:"button",className:"flex items-center text-gray-600 hover:text-gray-900 focus:outline-none p-1","aria-expanded":n,children:n?e.jsx(g,{}):e.jsx(_,{})})]}),e.jsx("div",{className:`transition-all duration-300 ${n?"max-h-full":"overflow-hidden max-h-0"}`,children:a})]})}function F({isDisabled:l,children:d,...r}){return e.jsx("button",{type:"button",className:`btn btn--sm btn--primary ${l?"cursor-not-allowed opacity-50":"cursor-pointer"}`,disabled:l,...r,children:d})}function O({data:l,setData:d,errors:r,processing:i,selectOption:u,page:a="User"}){const{bus:n,roles:h}=u,b=l.pivots.map(t=>t.bu_id).filter(t=>t!==""),j=t=>n.filter(s=>{var o;return!b.includes(s.value)||((o=l.pivots[t])==null?void 0:o.bu_id)===s.value}),m=t=>{const s=t([...l.pivots]);d("pivots",s)},y=()=>{m(t=>[...t,{bu_id:"",buSelected:"",role_id:"",roleSelected:""}])},v=async t=>{await $()&&m(o=>o.filter((c,S)=>S!==t))},N=(t,s)=>{m(o=>(o[s].bu_id=t.value,o[s].buSelected=t,o))},C=(t,s)=>{const o=t.map(c=>c.value);m(c=>(c[s].role_id=o,c[s].roleSelected=t,c))};return e.jsxs(E,{title:"Bu & Roles",children:[e.jsx("div",{className:"flex justify-end",children:a==="User"&&e.jsxs(F,{isDisabled:i,onClick:y,children:[e.jsx(D,{strokeWidth:3,size:16,className:"inline-block mb-1"})," Add Role"]})}),l.pivots.map((t,s)=>e.jsxs("div",{className:"flex flex-row items-start my-2",children:[a==="User"&&e.jsxs("button",{type:"button",className:`btn btn--sm btn--danger py-3 inline-block max-w-fit flex-none me-2 ${i||l.pivots.length==1?"cursor-not-allowed opacity-50":"cursor-pointer"}`,disabled:i||l.pivots.length==1,onClick:()=>v(s),children:[e.jsx(w,{strokeWidth:3,size:18,className:"mb-1 inline-block"})," Delete"]}),e.jsx(f,{error:r[`pivots.${s}.bu_id`],children:e.jsx(x,{options:j(s),value:t.buSelected,className:"mt-1 block w-80 me-2",menuPortalTarget:document.body,menuPosition:"fixed",placeholder:"Select Business Unit...",onChange:o=>N(o,s),required:!0,isDisabled:a==="Profile"})}),e.jsx(f,{className:"block w-full",error:r[`pivots.${s}.role_id`],children:e.jsx(x,{isMulti:!0,options:h,value:t.roleSelected,className:"mt-1 w-full",menuPortalTarget:document.body,menuPosition:"fixed",placeholder:"Select Roles...",onChange:o=>C(o,s),required:!0,isDisabled:a==="Profile"})})]},s)),e.jsxs("div",{className:"flex justify-end mt-2",children:[!i&&e.jsx(P,{routeName:a==="User"?"users.index":"dashboard"}),e.jsx(B,{disabled:i,children:"Submit"})]})]})}export{O as default};
